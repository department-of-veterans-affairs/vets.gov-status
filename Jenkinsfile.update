pipeline {
  agent any

  stages {
    stage('Get Credentials') {
      steps {
    		withCredentials([file(credentialsId: 'ga_serviceaccount', variable: 'GA_SERVICEACCOUNT')]) {
          sh 'cp ${GA_SERVICEACCOUNT} scripts/'
      }
    }
    stage('Update Data') {
      agent {
        dockerfile { 
          dir 'scripts'
          args '-v ${PWD}/_data:/data --rm'
          }
      }
      steps {
          sh '/application/updates.sh'
        }
      }
    }
  }
}
